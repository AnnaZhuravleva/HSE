This paper concerns the cohomological aspects of Donaldson-Thomas theory for Jacobi algebras and the associated cohomological Hall algebra, introduced by Kontsevich and Soibelman. We prove the Hodge-theoretic categorification of the integrality conjecture and the wall crossing formula, and furthermore realise the isomorphism in both of these theorems as Poincar\'e-Birkhoff-Witt isomorphisms for the associated cohomological Hall algebra. We do this by defining a perverse filtration on the cohomological Hall algebra, a result of the "hidden properness" of the semisimplification map from the moduli stack of semistable representations of the Jacobi algebra to the coarse moduli space of polystable representations. This enables us to construct a degeneration of the cohomological Hall algebra, for generic stability condition and fixed slope, to a free supercommutative algebra generated by a mixed Hodge structure categorifying the BPS invariants. As a corollary of this construction we furthermore obtain a Lie algebra structure on this mixed Hodge structure - the Lie algebra of BPS invariants - for which the entire cohomological Hall algebra can be seen as the positive part of a Yangian-type quantum group.