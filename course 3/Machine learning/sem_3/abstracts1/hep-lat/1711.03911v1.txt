We recently obtained an estimate of the axion mass based on the hypothesis that axions make up most of the dark matter in the universe. A key ingredient for this calculation was the temperature-dependence of the topological susceptibility of full QCD. Here we summarize the calculation of the susceptibility in a range of temperatures from well below the finite temperature cross-over to around 2 GeV. The two main difficulties of the calculation are the unexpectedly slow convergence of the susceptibility to its continuum limit and the poor sampling of nonzero topological sectors at high temperature. We discuss how these problems can be solved by two new techniques, the first one with reweighting using the quark zero modes and the second one with the integration method.