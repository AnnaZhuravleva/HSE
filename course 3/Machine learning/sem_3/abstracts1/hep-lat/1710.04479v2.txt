We calculate vector-vector correlation functions at two loops using partially quenched chiral perturbation theory including finite volume effects and twisted boundary conditions. We present expressions for the flavor neutral cases and the flavor charged case with equal masses. Using these expressions we give an estimate for the ratio of disconnected to connected contributions for the strange part of the electromagnetic current. We give numerical examples for the effects of partial quenching, finite volume and twisting and suggest the use of different twists to check the size of finite volume effects. The main use of this work is expected to be for lattice QCD calculations of the hadronic vacuum polarization contribution to the muon anomalous magnetic moment.