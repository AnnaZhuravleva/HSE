The experimental study of nuclear reactions of astrophysical interest is greatly facilitated by a low-background, high-luminosity setup. The Laboratory for Underground Nuclear Astrophysics (LUNA) 400 kV accelerator offers ultra-low cosmic-ray induced background due to its location deep underground in the Gran Sasso National Laboratory (INFN-LNGS), Italy, and high intensity, 250-500 $\mu$A, proton and $\alpha$ ion beams. In order to fully exploit these features, a high-purity, recirculating gas target system for isotopically enriched gases is coupled to a high-efficiency, six-fold optically segmented bismuth germanate (BGO) $\gamma$-ray detector. The beam intensity is measured with a beam calorimeter with constant temperature gradient. Pressure and temperature measurements have been carried out at several positions along the beam path, and the resultant gas density profile has been determined. Calibrated $\gamma$-intensity standards and the well-known $E_p$ = 278 keV $\mathrm{^{14}N(p,\gamma)^{15}O}$ resonance were used to determine the $\gamma$-ray detection efficiency and to validate the simulation of the target and detector setup. As an example, the recently measured resonance at $E_p$ = 189.5 keV in the $^{22}$Ne(p,$\gamma$)$^{23}$Na reaction has been investigated with high statistics, and the $\gamma$-decay branching ratios of the resonance have been determined.