We use microwaves to engineer repulsive long-range interactions between ultracold polar molecules. The resulting shielding suppresses various loss mechanisms and provides large elastic cross sections. Hyperfine interactions limit the shielding under realistic conditions, but a magnetic field allows suppression of the losses to below 10-14 cm3 s-1. The mechanism and optimum conditions for shielding differ substantially from those proposed by Gorshkov et al. [Phys. Rev. Lett. 101, 073201 (2008)], and do not require cancelation of the long-range dipole-dipole interaction that is vital to many applications.