In order to investigate the nuclear symmetry energy at high density, we study the pion production in central collisions of neutron-rich nuclei ${}^{132}\mathrm{Sn}+{}^{124}\mathrm{Sn}$ at 300 MeV/nucleon using a new approach by combining the antisymmetrized molecular dynamics (AMD) and a hadronic cascade model (JAM). The dynamics of neutrons and protons is solved by AMD, and then pions and $\Delta$ resonances in the reaction process are handled by JAM. We see the mechanism how the $\Delta$ resonance and pions are produced reflecting the dynamics of neutrons and protons. We also investigate the impacts of cluster correlations as well as of the high-density symmetry energy on the nucleon dynamics and consequently on the pion ratio. We find that the $\Delta^-/\Delta^{++}$ production ratio agrees very well with the neutron-proton squared ratio $(N/Z)^2$ in the high-density and high-momentum region. We show quantitatively that $\Delta$ production ratio, and therefore $(N/Z)^2$, are directly reflected in the $\pi^-/\pi^+$ ratio, with modification in the final stage of the reaction.