A method to evaluate the particle-phonon coupling (PC) corrections to the single-particle energies in semi-magic nuclei, based on the direct solution of the Dyson equation with PC corrected mass operator, is presented. It is used for finding the odd-even mass difference between even Pb and Sn isotopes and their odd-proton neighbors. The Fayans energy density functional (EDF) DF3-a is used which gives rather highly accurate predictions for these mass differences already at the mean-field level. In the case of the lead chain, account for the PC corrections induced by the low-laying phonons $2^+_1$ and $3^-_1$ makes agreement of the theory with the experimental data significantly better. For the tin chain, the situation is not so definite. In this case, the PC corrections make agreement better in the case of the addition mode but they spoil the agreement for the removal mode. We discuss the reason of such a discrepancy.