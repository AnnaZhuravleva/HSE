This work studies the interplay between Green functions, the index of determinacy of spectral measures and interior finite rank perturbations of Jacobi operators. The index of determinacy quantifies the stability of uniqueness of solutions of the moment problem. We give results on the constancy of this index in terms of perturbations of the corresponding Jacobi operators. The permanence of the $N$-extremality of a measure is also studied. A measure $\mu$ is $N$-extremal when the polynomials are dense in $L_2(\mathbb{R},\mu)$. As a by-product, we give a characterization of the index in terms of cyclic vectors. We consider a new inverse problem for Jacobi operators in which information on the place where the interior perturbation occurs is obtained from the index of determinacy.