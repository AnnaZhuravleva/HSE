Given a map of vector bundles on a smooth variety, consider the deepest degeneracy locus where its rank is smallest. We show it carries a natural perfect obstruction theory whose virtual cycle can be calculated by the Thom-Porteous formula.   We apply this to nested Hilbert schemes of points and curves on surfaces, by showing they can be expressed both as degeneracy loci and as "reduced" degeneracy loci. The resulting virtual cycles agree with the ones coming from DT and VW theories respectively.   This enables us to compute some DT and VW invariants in terms of Carlsson-Okounkov operators, proving and extending a conjecture of Gholampour-Sheshmani-Yau. We also generalise a vanishing result of Carlsson-Okounkov.