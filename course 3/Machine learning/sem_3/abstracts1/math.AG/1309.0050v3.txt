Motivated by the S-duality conjecture, we study the Donaldson-Thomas invariants of the 2 dimensional Gieseker stable sheaves on a threefold. These sheaves are supported on the fibers of a nonsingular threefold X fibered over a nonsingular curve. In the case where X is a K3 fibration, we express these invariants in terms of the Euler characteristic of the Hilbert scheme of points on the K3 fiber and the Noether-Lefschetz numbers of the fibration. We prove that a certain generating function of these invariants is a vector modular form of weight -3/2 as predicted in S-duality.