Let $S$ be a K3 surface and let $E$ be an elliptic curve. We solve the reduced Gromov-Witten theory of the Calabi-Yau threefold $S \times E$ for all curve classes which are primitive in the K3 factor. In particular, we deduce the Igusa cusp form conjecture.   The proof relies on new results in the Gromov-Witten theory of elliptic curves and K3 surfaces. We show the generating series of Gromov-Witten classes of an elliptic curve are cycle-valued quasimodular forms and satisfy a holomorphic anomaly equation. The quasimodularity generalizes a result by Okounkov and Pandharipande, and the holomorphic anomaly equation proves a conjecture of Milanov, Ruan and Shen. We further conjecture quasimodularity and holomorphic anomaly equations for the cycle-valued Gromov-Witten theory of every elliptic fibration with section. The conjecture generalizes the holomorphic anomaly equations for ellliptic Calabi-Yau threefolds predicted by Bershadsky, Cecotti, Ooguri, and Vafa. We show a modified conjecture holds numerically for the reduced Gromov-Witten theory of K3 surfaces in primitive classes.