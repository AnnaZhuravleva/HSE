The Einstein's weak equivalence principle (WEP) is one of the foundational assumptions of general relativity and some other gravity theories. In the theory of parametrized post-Newtonian (PPN), the difference between the PPN parameters $\gamma$ of different particles or the same type of particle with different energies, $\Delta \gamma$, represents the violation of WEP. Current constraints on $\Delta \gamma$ are derived from the observed time delay between correlated particles of astronomical sources. However, the observed time delay is contaminated by other effects, such as the time delays due to different particle emission times, the potential Lorentz invariance violation and none-zero photon rest mass. Therefore, current constraints are only upper limits. Here we propose a new method to test WEP based on the fact that the gravitational time delay is direction-dependent while others are not. This is the first method which can naturally correct other time delay effects. Using the time delay measurements of BASTE gamma-ray burst (GRB) sample and the gravitational potential of local super galaxy cluster Laniakea, we find that the constraint on $\Delta \gamma$ of different energy photons can be as low as $10^{-14}$. In the future, if more gravitational wave events and fast radio bursts with much more precise time delay measurements are observed, this method can give a reliable and tight constraint on WEP.