We investigate the resonant transmission of a single photon through a system of optical microcavities and atoms and show that the cumulative action of atoms can compensate for the system dissipation and ensure complete conversion of the photon frequency. The bandwidth of this inelastic transmission increases with the number of resonant atoms while its spectrum can be flattened by simple tuning of the waveguide-cavity coupling.