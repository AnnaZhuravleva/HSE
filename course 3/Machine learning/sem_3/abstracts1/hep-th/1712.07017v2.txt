We apply the modular approach to computing the topological string partition function on non-compact elliptically fibered Calabi-Yau 3-folds with higher Kodaira singularities in the fiber. The approach consists in making an ansatz for the partition function at given base degree, exact in all fiber classes to arbitrary order and to all genus, in terms of a rational function of weak Jacobi forms. Our results yield, at given base degree, the elliptic genus of the corresponding non-critical 6d string, and thus the associated BPS invariants of the 6d theory. The required elliptic indices are determined from the chiral anomaly 4-form of the 2d worldsheet theories, or the 8-form of the corresponding 6d theories, and completely fix the holomorphic anomaly equation constraining the partition function. We introduce subrings of the known rings of Weyl invariant Jacobi forms which are adapted to the additional symmetries of the partition function, making its computation feasible to low base wrapping number. In contradistinction to the case of simpler singularities, generic vanishing conditions on BPS numbers are no longer sufficient to fix the modular ansatz at arbitrary base wrapping degree. We show that to low degree, imposing exact vanishing conditions does suffice, and conjecture this to be the case generally.