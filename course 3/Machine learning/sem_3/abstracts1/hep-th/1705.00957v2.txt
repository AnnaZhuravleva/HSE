We study twist-field representations of the W-algebras and generalize the construction of the corresponding vertex operators to D- and B-series. We demonstrate how the computation of characters of such representations leads to the nontrivial identities involving lattice theta-functions. We propose a construction of their exact conformal blocks, which for D-series expresses them in terms of geometric data of corresponding Prym variety.