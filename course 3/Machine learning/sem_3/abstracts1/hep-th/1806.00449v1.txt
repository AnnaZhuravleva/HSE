The closed string field theory minimal-area problem asks for the conformal metric of least area on a Riemann surface with the condition that all non-contractible closed curves have length at least 2\pi. This is an extremal length problem in conformal geometry as well as a problem in systolic geometry. We consider the analogous minimal-area problem for homology classes of curves and, with the aid of calibrations and the max flow-min cut theorem, formulate it as a local convex program. We derive an equivalent dual program involving maximization of a concave functional. These two programs give new insights into the form of the minimal-area metric and are amenable to numerical solution. We explain how the homology problem can be modified to provide the solution to the original homotopy problem.