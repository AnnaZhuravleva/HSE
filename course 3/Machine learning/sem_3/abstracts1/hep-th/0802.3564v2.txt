Recently, it was found by Greene and Levin that the Casimir energy of certain combinations of massless and massive fields in space with extra dimensions play a crucial role in the accelerated expansion of the late-time universe and therefore it could serve as a candidate for the dark energy. It also provides a mechanism in stabilizing the volume moduli of extra dimensions. However, the shape moduli of the extra dimensions were never taken into account in the previous work. We therefore study the stabilization mechanism for both volume and shape moduli due to the Casimir energy in ${\mathbb M}^{1+3} \times {\mathbb T}^{2}$. The result of our study shows that the previously known local minimum is a saddle point. It is unstable to the perturbations in the direction of the shape moduli. The new stable local minima stabilizes all the moduli and drives the accelerating expansion of the universe. The cosmological dynamics both in the bulk and the radion pictures are derived and simulated. The equations of state for the Casimir energy in a general torus are derived. Shear viscosity in extra dimensions induced by the Casimir density in the late times is identified and calculated, it is found to be proportional to the Hubble constant.