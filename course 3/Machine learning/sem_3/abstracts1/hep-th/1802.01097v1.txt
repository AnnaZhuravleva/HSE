We complement Weinberg's no go theorem on the cosmological constant problem in quantum gravity by generalizing it to the case of a scale-invariant theory. Our analysis makes use of the effective action and the BRST symmetry in a manifestly covariant quantum gravity instead of the classical Lagrangian density and the $GL(4)$ symmetry in classical gravity. In this sense, our proof is very general since it does not depend on details of quantum gravity and holds true for general gravitational theories which are invariant under diffeomorphisms. As an application of our theorem, we comment on an idea that in the asymptotic safety scenario the functional renormalization flow drives a cosmological constant to zero, solving the cosmological constant problem without reference to fine tuning of parameters. Finally, we also comment on the possibility of extending the Weinberg theorem in quantum gravity to the case where the translational invariance is spontaneously broken.