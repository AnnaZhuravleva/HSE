We consider a recently proposed generalization of unimodular gravity, where the lapse function is constrained to be equal to a function of the determinant of the spatial metric $f(h)$, as a potential origin of a dark fluid with a generally $h$-dependent equation of state parameter. We establish the Hamiltonian analysis and the canonical path integral for the theory. All the special cases that do not match unimodular gravity involve violation of general covariance, and consequently the physical content of the theory is changed significantly. Particularly, the case of a constant function $f$ is shown to contain an extra physical degree of freedom in each point of space. Physical consequences of the extra degree of freedom are studied in a linearized theory, where the extra mode is carried by the trace of the metric perturbation. The trace mode does not propagate as a wave, since it satisfies an elliptic partial differential equation in spacetime. Consequently, the trace perturbation is shown to grow exponentially with time, which implies instability. The case of a general $f(h)$ involves additional second-class constraints, which implies the presence of an extra global degree of freedom that depends only on time (instead of the extra local degree of freedom in the case of a constant $f$).