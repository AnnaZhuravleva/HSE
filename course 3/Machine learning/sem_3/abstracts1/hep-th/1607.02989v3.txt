We propose a closed gauge-invariant functional flow equation for Yang-Mills theories and quantum gravity that only involves one macroscopic gauge field or metric. It is based on a projection on physical and gauge fluctuations. Deriving this equation from a functional integral we employ the freedom in the precise choice of the macroscopic field and the effective average action in order to realize a closed and simple form of the flow equation.