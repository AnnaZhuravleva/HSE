We investigate the relation between 4d ambitwistor string theory and on-shell diagrams for planar N=4 super-Yang-Mills and N=8 supergravity, and deduce several new results about their scattering amplitudes at tree-level and 1-loop. In particular, we derive new Grassmannian integral formulae for tree-level amplitudes and obtain new worldsheet formulae for 1-loop amplitudes which are manifestly supersymmetric and supported on scattering equations refined by MHV degree.