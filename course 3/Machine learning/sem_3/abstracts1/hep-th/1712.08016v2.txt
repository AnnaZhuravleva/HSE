We describe the general strategy for lifting the Wess-Zumino-Witten model from the level of one-loop Kac-Moody $U_q(\widehat{\mathfrak{g}})_k$ to generic quantum toroidal algebras. A nearly exhaustive presentation is given for the two series $U_{q,t}(\widehat{\widehat{\mathfrak{gl}}}_1)$ and $U_{q,t}(\widehat{\widehat{\mathfrak{gl}}}_n)$, when screenings do not exist and thus all the correlators are purely algebraic, i.e. do not include additional hypergeometric type integrations/summations. Generalizing the construction of the intertwiner (refined topological vertex) of the Ding-Iohara-Miki (DIM) algebra, we obtain the intertwining operators of the Fock representations of the quantum toroidal algebra of type $A_n$. The correlation functions of these operators satisfy the $(q,t)$-Knizhnik-Zamolodchikov (KZ) equation, which features the ${\cal R}$-matrix. Matching with the Nekrasov function for the instanton counting on the ALE space is worked out explicitly. We also present an important application of the DIM formalism to the study of $6d$ gauge theories described by the double elliptic integrable systems. We show that the modular and periodicity properties of the gauge theories are neatly explained by the network matrix models providing solutions to the elliptic $(q,t)$-KZ equations.