[Context] The first detection of an atmosphere around an extrasolar planet was presented by Charbonneau and collaborators in 2002. In the optical transmission spectrum of the transiting exoplanet HD209458b, an absorption signal from sodium was measured at a level of 0.023+-0.006%, using the STIS spectrograph on the Hubble Space Telescope. Despite several attempts, so far only upper limits to the Na D absorption have been obtained using telescopes from the ground, and the HST result has yet to be confirmed.   [Aims] The aims of this paper are to re-analyse data taken with the High Dispersion Spectrograph on the Subaru telescope, to correct for systematic effects dominating the data quality, and to improve on previous results presented in the literature.   [Methods] The data reduction process was altered in several places, most importantly allowing for small shifts in the wavelength solution. The relative depth of all lines in the spectra, including the two sodium D lines, are found to correlate strongly with the continuum count level in the spectra. These variations are attributed to non-linearity effects in the CCDs. After removal of this empirical relation the uncertainties in the line depths are only a fraction above that expected from photon statistics.   [Results] The sodium absorption due to the planet's atmosphere is detected at >5 sigma, at a level of 0.056+-0.007% (2x3.0 Ang band), 0.070+-0.011% (2x1.5 Ang band), and 0.135+-0.017% (2x0.75 Ang band). There is no evidence that the planetary absorption signal is shifted with respect to the stellar absorption, as recently claimed for HD189733b. The measurements in the two most narrow bands indicate that some signal is being resolved.[abridged]