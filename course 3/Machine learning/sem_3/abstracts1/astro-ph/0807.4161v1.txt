We consider a troublesome form of non-isoplanatism in synthesis radio telescopes: non-coplanar baselines. We present a novel interpretation of the non-coplanar baselines effect as being due to differential Fresnel diffraction in the neighborhood of the array antennas.   We have developed a new algorithm to deal with this effect. Our new algorithm, which we call "W-projection", has markedly superior performance compared to existing algorithms. At roughly equivalent levels of accuracy, W-projection can be up to an order of magnitude faster than the corresponding facet-based algorithms. Furthermore, the precision of result is not tightly coupled to computing time.   W-projection has important consequences for the design and operation of the new generation of radio telescopes operating at centimeter and longer wavelengths.