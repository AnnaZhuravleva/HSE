We present a general radiative transfer model which allows the Zeeman diagnostics of complex and unresolved solar magnetic fields. Present modeling techniques still rely to a large extent on a-priori assumptions about the geometry of the underlying magnetic field. In an effort to obtain a more flexible and unbiased approach we pursue a rigorous statistical description of the underlying atmosphere. Based on a Markov random field model the atmospheric structures are characterized in terms of probability densities and spatial correlations. This approach allows us to derive a stochastic transport equation for polarized light valid in a regime with an arbitrary fluctuating magnetic field on finite scales. One of the key ingredients of the derived stochastic transfer equation is the correlation length which provides an additional degree of freedom to the transport equation and can be used as a diagnostic parameter to estimate the characteristic length scale of the underlying magnetic field.   It is shown that the stochastic transfer equation represents a natural extension of the (polarized) line formation under the micro- and macroturbulent assumption and contains both approaches as limiting cases. In particular, we show how in an inhomogeneous atmosphere asymmetric Stokes profiles develop and that the correlation length directly controls the degree of asymmetry and net circular polarization (NCP). In a number of simple numerical model calculations we demonstrate the importance of a finite correlation length for the polarized line formation and its impact on the resulting Stokes line profiles.