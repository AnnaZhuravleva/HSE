Stellar winds are an important aspect of our understanding of the evolution of massive stars and their input into the interstellar medium. Here we present solutions for the velocity field and mass-loss rates for stellar outflows as well as for the case of mass accretion through the use of the so-called Lambert W-function. For the case of a radiation-driven wind, the velocity field is obtained analytically using a parameterised description for the line acceleration that only depends on radius, which we obtain from Monte-Carlo multi-line radiative transfer calculations. In our form of the equation of motion the critical point is the sonic point. We also derive an approximate analytical solution for the supersonic flow which closely resembles our exact solution. For the simultaneous solution of the mass-loss rate and velocity field, we describe a new iterative method. We apply our theoretical expressions and our iterative method to the stellar wind from a typical O5-V main sequence star, and find good agreement with empirical values. Our computations represent a self-consistent mass-loss calculation including the effect of multi-line scattering for an O-type star, opening up the possibility of applying Monte Carlo mass-loss calculations in regions of the Universe for which empirical constraints cannot be readily obtained.