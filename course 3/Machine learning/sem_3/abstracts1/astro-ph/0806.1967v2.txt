AIMS. While weak lensing cannot resolve cluster cores and strong lensing is almost insensitive to density profiles outside the scale radius, combinations of both effects promise to constrain density profiles of galaxy clusters well, and thus to allow testing of the CDM expectation on dark-matter halo density profiles.   METHODS. We develop an algorithm further that we had recently proposed for this purpose. It recovers a lensing potential optimally reproducing observations of both strong and weak-lensing effects by combining high resolution in cluster cores with the larger-scale information from weak lensing. The main extensions concern the accommodation of mild non-linearity in inner iterations, the progressive increase in resolution in outer iterations, and the introduction of a suitable regularisation term. The linearity of the method is essentially preserved.   RESULTS. We demonstrate the success of the algorithm with both idealised and realistic simulated data, showing that the simulated lensing mass distribution and its density profile are well reproduced. We then apply it to weak and strong lensing data of the cluster MS 2137 and obtain a parameter-free solution which is in good qualitative agreement with earlier parametric studies.