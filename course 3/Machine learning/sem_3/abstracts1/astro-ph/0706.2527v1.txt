Many models of gamma-ray bursts suggest a common central engine: a black hole of several solar masses accreting matter from a disk at an accretion rate from 0.01 to 10 M_\sun / s. The inner region of the disk is cooled by neutrino emission and large amounts of its binding energy were liberated, which could trigger the fireball. We improve the neutrino-dominated accreting flows by considering the effects of the magnetic fields, and find that more than half of the liberating energy can be extracted directly by the large-scale magnetic fields on the disk. And it turns out that the temperature of the disk is a bit lower than the neutrino-dominated accreting flows without magnetic field. Therefore, The outflows are magneticallydominated rather than neutrino dominated. In our model, neutrino mechanism can fuel some GRBs (not the brightest ones), but cannot fuel X-ray flares. However, the magnetic processes (both BZ and electromagnetic luminosity from a disk) are viable mechanisms for most of GRBs and the following X-ray flares.