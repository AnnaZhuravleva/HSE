Observations of two H$_2$CO ($3_{03}-2_{02}$ and $3_{21}-2_{20}$) lines and continuum emission at 1.3 mm towards Sgr B2(N) and Sgr B2(M) have been carried out with the SMA. The mosaic maps of Sgr B2(N) and Sgr B2(M) in both continuum and lines show a complex distribution of dust and molecular gas in both clumps and filaments surrounding the compact star formation cores. We have observed a decelerating outflow originated from the Sgr B2(M) core, showing that both the red-shifted and blue-shifted outflow components have a common terminal velocity. This terminal velocity is 58$\pm$2 km s$^{-1}$. It provides an excellent method in determination of the systematic velocity of the molecular cloud. The SMA observations have also shown that a large fraction of absorption against the two continuum cores is red-shifted with respect to the systematic velocities of Sgr B2(N) and Sgr B2(M), respectively, suggesting that the majority of the dense molecular gas is flowing into the two major cores where massive stars have been formed. We have solved the radiative transfer in a multi-level system with LVG approximation. The observed H$_2$CO line intensities and their ratios can be adequately fitted with this model for the most of the gas components. However, the line intensities between the higher energy level transition H$_2$CO ($3_{21}-2_{20}$) and the lower energy level transition H$_2$CO ($3_{03}-2_{02}$) is reversed in the red-shifted outflow region of Sgr B2(M), suggesting the presence of inversion in population between the ground levels in the two K ladders (K$_{-1}$= 0 and 2). The possibility of weak maser processes for the H$_2$CO emission in Sgr B2(M) is discussed.