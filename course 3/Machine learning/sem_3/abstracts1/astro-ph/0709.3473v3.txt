We present a matrix solution to the full equations of statistical equilibrium that give the energy level populations of collisionally-excited ions in photoionised gaseous nebulae. The rationale for such a calculation is to maintain a parity between improvements in the quantum-mechanically evaluated values for collision strengths and transition probabilities from the Iron and Opacity Projects on the one hand, and 3D photoionisation codes such as MOCASSIN and astrophysical software for producing nebular diagnostics such as the Nebular package for IRAF, on the other. We have taken advantage of the fact that mathematics programs such as MATLAB and Mathematica have proven to be very adept at symbolic manipulation providing a route to exact solutions for the n-level ion. In particular, we have avoided the substitution of estimated values. We provide the matrix solution for the 5-level ion as an example and show how the equations faithfully reduce to the exact solution for the 3-level ion. Through the forbidden line ratio R23, we compare the exact solution with a) that obtained from the observed emission of the spherical planetary nebula Abell 39, b) 3D Monte-Carlo photoionisation modelling of the same nebula, c) the approximate 5-level program TEMDEN and d) the exact 3-level ion. The general solution presented here means that programs for the calculation of level populations can obtain solutions for ions with a user-specified number of excited levels. The use of a separate and updatable database of atomic and ionic constants such as that provided by NIST, means that software of more general application can now be made available; particularly for the study of high excitation objects such as active galactic nebulae (AGNs) and supernovae (SNs) where higher excited levels become significant.