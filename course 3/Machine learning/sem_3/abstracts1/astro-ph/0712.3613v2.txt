We present a comparison between the SCUBA Half Degree Extragalactic Survey (SHADES) at 450 and 850 microns in the Lockman Hole East with a deep Spitzer Space Telescope survey at 3.6-24 microns conducted in Guaranteed Time. Using stacking analyses we demonstrate a striking correspondence between the galaxies contributing the submm extragalactic background light, with those likely to dominate the backgrounds at Spitzer wavelengths. Using a combination BRIzK plus Spitzer photometric redshifts, we show that at least a third of the Spitzer-identified submm galaxies at 1<z<1.5 appear to reside in overdensities when the density field is smoothed at 0.5-2 Mpc comoving diameters, supporting the high-redshift reversal of the local star formation - galaxy density relation. We derive the dust-shrouded cosmic star formation history of galaxies as a function of assembled stellar masses. For model stellar masses <10^11 Msun, this peaks at lower redshifts than the ostensible z~2.2 maximum for submm point sources, adding to the growing consensus for ``downsizing'' in star formation. Our surveys are also consistent with ``downsizing'' in mass assembly. Both the mean star formation rates <dM/dt> and specific star formation rates <(1/M)dM/dt> are in striking disagreement with some semi-analytic predictions from the Millenium simulation. The discrepancy could either be resolved with a top-heavy initial mass function, or a significant component of the submm flux heated by the interstellar radiation field.