Gas-phase processes were long thought to be the key formation mechanisms for complex organic molecules in star-forming regions. However, recent experimental and theoretical evidence has cast doubt on the efficiency of such processes. Grain-surface chemistry is frequently invoked as a solution, but until now there have been no quantitative models taking into account both the high degree of chemical complexity and the evolving physical conditions of star-forming regions. Here, we introduce a new gas-grain chemical network, wherein a wide array of complex species may be formed by reactions involving radicals. The radicals we consider (H, OH, CO, HCO, CH3, CH3O, CH2OH, NH and NH2) are produced primarily by cosmic ray-induced photodissociation of the granular ices formed during the colder, earlier stages of evolution. The gradual warm-up of the hot core is crucial to the formation of complex molecules, allowing the more strongly-bound radicals to become mobile on grain surfaces. This type of chemistry is capable of reproducing the high degree of complexity seen in Sgr B2(N), and can explain the observed abundances and temperatures of a variety of previously detected complex organic molecules, including structural isomers. Many other complex species are predicted by this model, and several of these species may be detectable in hot cores. Differences in the chemistry of high- and low-mass star-formation are also addressed; greater chemical complexity is expected where evolution timescales are longer.