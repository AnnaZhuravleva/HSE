We describe a phenomenological model for molecular hydrogen formation suited for applications in galaxy formation simulations, which includes on-equilibrium formation of molecular hydrogen on dust and approximate treatment of both its self-shielding and shielding by dust from the dissociating UV radiation. The model is applicable in simulations in which individual star forming regions - the giant molecular complexes - can be identified (resolution of tens of pc) and their mean internal density estimated reliably, even if internal structure is not resolved. In agreement with previous studies, calculations based on our model show that the transition from atomic to fully molecular phase depends primarily on the metallicity, which we assume is directly related to the dust abundance, and clumpiness of the interstellar medium. The clumpiness simply boosts the formation rate of molecular hydrogen, while dust serves both as a catalyst of molecular hydrogen formation and as an additional shielding from dissociating UV radiation. The upshot is that it is difficult to form fully-shielded giant molecular clouds while gas metallicity is low. However, once the gas is enriched to Z ~ 0.01-0.1 solar, the subsequent star formation and enrichment can proceed at a much faster rate. This may keep star formation efficiency in the low-mass, low-metallicity progenitors of galaxies very low for a certain period of time with the effect similar to a strong "feedback" mechanism. [abridged]