We explore the onset of star formation in the early Universe, exploiting the observations of high-redshift Lyman-break galaxies (LBGs) and Lyman alpha emitters (LAEs), in the framework of the galaxy formation scenario elaborated by Granato et al. (2004) already successfully tested against the wealth of data on later evolutionary stages. Complementing the model with a simple, physically plausible, recipe for the evolution of dust attenuation in metal poor galaxies we reproduce the luminosity functions (LFs) of LBGs and of LAEs at different redshifts. This recipe yields a much faster increase with galactic age of attenuation in more massive galaxies, endowed with higher star formation rates. These objects have therefore shorter lifetimes in the LAE and LBG phases, and are more easily detected in the dusty submillimeter bright phase. The short UV bright lifetimes of massive objects strongly mitigate the effect of the fast increase of the massive halo density with decreasing redshift, thus accounting for the weaker evolution of the LBG LF, compared to that of the halo mass function, and the even weaker evolution between z~6 and z~3 of the LAE LF. LAEs are on the average expected to be younger, with lower stellar masses, and associated to less massive halos than LBGs. Finally, we show that the intergalactic medium can be completely reionized at redshift z~6-7 by massive stars shining in protogalactic spheroids with halo masses from a few 10^10 to a few 10^11 M_sun, showing up as faint LBGs with magnitude in the range -17<M_1350<-20, without resorting to any special stellar initial mass function.