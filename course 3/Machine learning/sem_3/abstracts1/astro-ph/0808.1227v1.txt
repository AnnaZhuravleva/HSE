We present a new semi-analytic model that self-consistently traces the growth of supermassive black holes (BH) and their host galaxies within the context of the LCDM cosmological framework. In our model, the energy emitted by accreting black holes regulates the growth of the black holes themselves, drives galactic scale winds that can remove cold gas from galaxies, and produces powerful jets that heat the hot gas atmospheres surrounding groups and clusters. We present a comprehensive comparison of our model predictions with observational measurements of key physical properties of low-redshift galaxies, such as cold gas fractions, stellar metallicities and ages, and specific star formation rates. We find that our new models successfully reproduce the exponential cutoff in the stellar mass function and the stellar and cold gas mass densities at z~0, and predict that star formation should be largely, but not entirely, quenched in massive galaxies at the present day. We also find that our model of self-regulated BH growth naturally reproduces the observed relation between BH mass and bulge mass. We explore the global formation history of galaxies in our models, presenting predictions for the cosmic histories of star formation, stellar mass assembly, cold gas, and metals. We find that models assuming the "concordance" LCDM cosmology overproduce star formation and stellar mass at high redshift (z>2). A model with less small-scale power predicts less star formation at high redshift, and excellent agreement with the observed stellar mass assembly history, but may have difficulty accounting for the cold gas in quasar absorption systems at high redshift (z~3-4).