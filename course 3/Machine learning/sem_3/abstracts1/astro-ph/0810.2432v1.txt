We analyse spectropolarimetric observations of the penumbra of the NOAA AR 10953 at high spatial resolution (0.3"). The full Stokes profiles of the Fe I lines at 630.1 nm and 630.2 nm have been obtained with the Solar Optical Telescope (SOT) on board the Hinode satellite. The data have been inverted by means of the SIR code, deriving the stratifications of temperature, line of sight velocity, and the components of the magnetic field vector in optical depth. In order to evaluate the gas pressure and to obtain an adequate geometrical height scale, the motion equation has been integrated for each pixel taking into account the terms of the Lorentz force. To establish the boundary condition, a genetic algorithm has been applied. The final resulting magnetic field has a divergence compatible with 0 inside its uncertainties. First analyses of the correlation of the Wilson depression with velocity, temperature, magnetic field strength, and field inclination strongly support the uncombed penumbral model proposed by Solanki & Montavon (1993).