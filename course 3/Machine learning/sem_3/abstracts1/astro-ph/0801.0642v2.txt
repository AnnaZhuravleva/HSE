We cross-correlate large scale structure (LSS) observations from a number of surveys with CMB anisotropies from WMAP to investigate the Integrated Sachs-Wolfe (ISW) effect as a function of redshift, covering z~0.1-2.5. Our main goal is to go beyond reporting detections towards developing a reliable likelihood analysis that allows one to determine cosmological constraints from ISW observations. With this in mind we spend a considerable amount of effort in determining the redshift-dependent bias and redshift distribution b(z)*dN/dz of these samples by matching with spectroscopic observations where available, and analyzing auto-power spectra and cross-power spectra between the samples. The data sets we use are 2-Micron All Sky Survey (2MASS) samples, Sloan Digital Sky Survey (SDSS) photometric Luminous Red Galaxies, SDSS photometric quasars and NRAO VLA Sky Survey (NVSS) radio sources. We make a joint analysis of all samples constructing a full covariance matrix, which we subsequently use for cosmological parameter fitting. We report a 3.7 sigma detection of ISW combining all the datasets. We combine the ISW likelihood function with weak lensing of CMB and CMB power spectrum to constrain the equation of state of dark energy and the curvature of the Universe. While ISW does not significantly improve the constraints in the simplest 6-parameter flat Lambda CDM model, it improves constraints on 7-parameter models with curvature by a factor of 3.2 (relative to WMAP alone) to Omega_K=-0.004^{+0.014}_{-0.020}, and with dark energy equation of state by 15% to w=-1.01^{+0.30}_{-0.40}. (Abridged.)