Massive stars are very rare, but their extreme luminosities make them both the only type of young star we can observe in distant galaxies and the dominant energy sources in the universe today. They form rarely because efficient radiative cooling keeps most star-forming gas clouds close to isothermal as they collapse, and this favors fragmentation into stars <~1 Msun. Heating of a cloud by accreting low-mass stars within it can prevent fragmentation and allow formation of massive stars, but what properties a cloud must have to form massive stars, and thus where massive stars form in a galaxy, has not yet been determined. Here we show that only clouds with column densities >~ 1 g cm^-2 can avoid fragmentation and form massive stars. This threshold, and the environmental variation of the stellar initial mass function (IMF) that it implies, naturally explain the characteristic column densities of massive star clusters and the difference between the radial profiles of Halpha and UV emission in galactic disks. The existence of a threshold also implies that there should be detectable variations in the IMF with environment within the Galaxy and in the characteristic column densities of massive star clusters between galaxies, and that star formation rates in some galactic environments may have been systematically underestimated.