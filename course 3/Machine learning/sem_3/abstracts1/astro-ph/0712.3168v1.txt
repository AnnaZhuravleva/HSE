I deduced a 3-D sunspot model that is in agreement with spectropolarimetric observations, to address the question of penumbral heating by the repetitive rise of flow channels. I performed inversions of data taken simultaneously in infrared and visible spectral lines. I used two independent magnetic components to reproduce the irregular Stokes profiles in the penumbra. I studied the averaged and individual properties of the two components. By integrating the field inclination to the surface, I developed a 3-D model of the spot from inversion results without intrinsic height information. I find that the Evershed flow is harbored by the weaker of the two field components. This component forms flow channels that show upstreams in the inner and mid penumbra, continue horizontally as slightly elevated loops throughout the penumbra, and finally bend down in the outer penumbra. I find several examples, where two or more flow channels are found along a radial cut from the umbra to the outer boundary of the spot. I find that a model of horizontal flow channels in a static background field is in good agreement with the observed spectra. The properties of the flow channels correspond very well to the simulations of Schlichenmaier et al. (1998). From the temporal evolution in intensity images and the properties of the flow channels in the inversion, I conclude that interchange convection of rising hot flux tubes in a thick penumbra still seems a possible mechanism for maintaining the penumbral energy balance.