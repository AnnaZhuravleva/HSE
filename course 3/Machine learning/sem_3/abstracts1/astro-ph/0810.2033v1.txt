This proceeding summarises the talk of the awardee of the Spanish Astronomical Society award to the the best Spanish thesis in Astronomy and Astrophysics in the two-year period 2006-2007. The thesis required a tremendous observational effort and covered many different topics related to brown dwarfs and exoplanets, such as the study of the mass function in the substellar domain of the young sigma Orionis cluster down to a few Jupiter masses, the relation between the cluster stellar and substellar populations, the accretion discs in cluster brown dwarfs, the frequency of very low-mass companions to nearby young stars at intermediate and wide separations, or the detectability of Earth-like planets in habitable zones around ultracool (L- and T-type) dwarfs in the solar neighbourhood.