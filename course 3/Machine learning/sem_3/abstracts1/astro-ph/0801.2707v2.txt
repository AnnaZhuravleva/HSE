The solar magnetic field is key to understanding the physical processes in the solar atmosphere. Nonlinear force-free codes have been shown to be useful in extrapolating the coronal field upward from underlying vector boundary data. However, we can only measure the magnetic field vector routinely with high accuracy in the photosphere, and unfortunately these data do not fulfill the force-free condition. We must therefore apply some transformations to these data before nonlinear force-free extrapolation codes can be self-consistently applied. To this end, we have developed a minimization procedure that yields a more chromosphere-like field, using the measured photospheric field vectors as input. The procedure includes force-free consistency integrals, spatial smoothing, and -- newly included in the version presented here -- an improved match to the field direction as inferred from fibrils as can be observed in, e.g., chromospheric H$\alpha$ images. We test the procedure using a model active-region field that included buoyancy forces at the photospheric level. The proposed preprocessing method allows us to approximate the chromospheric vector field to within a few degrees and the free energy in the coronal field to within one percent.