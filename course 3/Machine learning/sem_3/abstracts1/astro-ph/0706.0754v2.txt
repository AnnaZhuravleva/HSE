The addition of metals to any gas can significantly alter its evolution by increasing the rate of radiative cooling. In star-forming environments, enhanced cooling can potentially lead to fragmentation and the formation of low-mass stars, where metal-free gas-clouds have been shown not to fragment. Adding metal cooling to numerical simulations has traditionally required a choice between speed and accuracy. We introduce a method that uses the sophisticated chemical network of the photoionization software, Cloudy, to include radiative cooling from a complete set of metals up to atomic number 30 (Zn) that can be used with large-scale three-dimensional hydrodynamic simulations. Our method is valid over an extremely large temperature range (10 K < T < 10^8 K), up to hydrogen number densities of 10^12 cm^-3. At this density, a sphere of 1 Msun has a radius of roughly 40 AU. We implement our method in the adaptive mesh refinement (AMR) hydrodynamic/N-body code, Enzo. Using cooling rates generated with this method, we study the physical conditions that led to the transition from Population III to Population II star formation. While C, O, Fe, and Si have been previously shown to make the strongest contribution to the cooling in low-metallicity gas, we find that up to 40% of the metal cooling comes from fine-structure emission by S, when solar abundance patterns are present. At metallicities, Z > 10^-4 Zsun, regions of density and temperature exist where gas is both thermally unstable and has a cooling time less than its dynamical time. We identify these doubly unstable regions as the most inducive to fragmentation. At high redshifts, the CMB inhibits efficient cooling at low temperatures and, thus, reduces the size of the doubly unstable regions, making fragmentation more difficult.