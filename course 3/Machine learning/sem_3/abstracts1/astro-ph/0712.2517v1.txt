We present a macroscopic calculation of coherent electro-magnetic radiation from air showers initiated by ultra-high energy cosmic rays, based on currents obtained from Monte Carlo simulations of air showers in a realistic geo-magnetic field. We can clearly relate the time signal to the time dependence of the currents. We find that the the most important contribution to the pulse is related to the time variation of the currents. For showers forming a sufficiently large angle with the magnetic field, the contribution due to the currents induced by the geo-magnetic field is dominant, but neither the charge excess nor the dipole contribution can be neglected. We find a characteristic bipolar signal. In our calculations, we take into account a realistic index of refraction, whose importance depends on the impact parameter and the inclination. Also very important is the role of the positive ions.