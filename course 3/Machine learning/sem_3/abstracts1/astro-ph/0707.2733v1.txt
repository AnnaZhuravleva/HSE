The probability of a star hosting a planet that is detectable in radial velocity surveys increases Ppl(Z) oc 10^2Z, where Z is metallicity. Core accretion models reproduce this trend, since the protoplanetary disk of a high metallicity star has a high density of solids and so forms cores which accrete gas before the primordial gas disk dissipates. This paper considers the origin of the form of Ppl(Z). We introduce a simple model in which detectable planets form when the mass of solids in the protoplanetary disk, Ms, exceeds a critical value. In this model the form of Ppl(Z) is a direct reflection of the distribution of protoplanetary disk masses, Mg, and the observed Ppl(Z) is reproduced if P(Mg>Mg') oc 1/Mg'^2. We argue that a protoplanetary disk's sub-mm dust mass is a pristine indicator of the mass available for planet-building and find the observed sub-mm disk mass distribution is consistent with the observed Ppl(Z) if Ms>0.5M_J is required to form detectable planets. Any planet formation model which imposes a critical solid mass for planet formation would reproduce the observed Ppl(Z), and core accretion models are empirically consistent with a threshold criterion. We identify 7 protoplanetary disks which, by rigid application of this criterion, would be expected to form detectable planets. A testable prediction is that Ppl(Z) should flatten both for Z>0.5dex and as more distant and lower mass planets are discovered. Further, combining this model with one in which the evolution of a star's debris disk is also influenced by the solid mass in its protoplanetary disk, results in the prediction that debris disks detected around stars with planets should be more infrared luminous than those around stars without planets in tentative agreement with recent observations.