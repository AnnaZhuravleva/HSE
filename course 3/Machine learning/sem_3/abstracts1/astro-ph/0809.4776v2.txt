Two radiation mechanisms, inverse Compton scattering (ICS) and synchrotron radiation (SR), suffice within the cannonball (CB) model of long gamma ray bursts (LGRBs) and X-ray flashes (XRFs) to provide a very simple and accurate description of their observed prompt emission and afterglows. Simple as they are, the two mechanisms and the burst environment generate the rich structure of the light curves at all frequencies and times. This is demonstrated for 33 selected Swift LGRBs and XRFs, which are well sampled from early until late time and faithfully represent the entire diversity of the broad-band light curves of Swift LGRBs and XRFs. Their prompt gamma-ray and X-ray emission is dominated by ICS of `glory' light. During their fast decline phase, ICS is taken over by SR, which dominates their broad-band afterglow. The pulse shape and spectral evolution of the gamma-ray peaks and the early-time X-ray flares, and even the delayed optical `humps' in XRFs, are correctly predicted. The `canonical' and non-canonical X-ray light curves and the chromatic behaviour of the broad-band afterglows are well reproduced. In particular, in canonical X-ray light curves, the initial fast decline and rapid softening of the prompt emission, the transition to the plateau phase, the subsequent gradual steepening of the plateau to an asymptotic power-law decay, and the transition from chromatic to achromatic behaviour of the light curves agrees well with those predicted by the CB model. The Swift early-time data on XRF 060218 are inconsistent with a black-body emission from a shock break-out through a stellar envelope. Instead, they are well described by ICS of glory light by a jet breaking out from SN2006aj.