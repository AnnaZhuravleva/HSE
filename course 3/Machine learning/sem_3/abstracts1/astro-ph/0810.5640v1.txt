Accreting sources such as AGN, X-ray binaries or gamma-ray bursts are known to be strong, high energy emitters. The hard emission is though to originate from plasmas of thermal and/or non-thermal high energy particles. Not only does this emission allow to probe the unique properties of the matter in an extreme environment, but it also has a crucial backreaction on the energetics and the dynamics of the emitting medium itself. Understanding interactions between radiation and matter has become a key issue in the modelling of high energy sources. Although most cross sections are well known, they are quite complex and the way all processes couple non-linearly is still an open issue.   We present a new code that solves the local, kinetic evolution equations for distributions of electrons, positrons and photons, interacting by radiation processes such as self-absorbed synchrotron and brems-strahlung radiation, Compton scattering, pair production/annihilation, and by Coulomb collisions. The code is very general and aimed to modelled various high energy sources. As an application, we study the spectral states of X-ray binaries, including thermalization by Coulomb collisions and synchrotron self-absorption. It is found that the low-hard and high-soft states can be modelled with different illumination but the same non-thermal acceleration mechanism.