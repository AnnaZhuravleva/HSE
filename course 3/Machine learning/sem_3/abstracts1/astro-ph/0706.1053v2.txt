We analyze the transmitted flux in a sample of 17 QSOs spectra at 5.74<zem<6.42 to obtain tighter constraints on the volume-averaged neutral hydrogen fraction, xHI, at z~6. We study separately the narrow transmission windows (peaks) and the wide dark portions (gaps) in the observed absorption spectra. By comparing the statistics of these spectral features with Lyalpha forest simulations, we conclude that xHI evolves smoothly from 10^{-4.4} at z=5.3 to 10^{-4.2} at z=5.6, with a robust upper limit xHI<0.36 at z=6.3. The frequency and physical sizes of the peaks imply an origin in cosmic underdense regions and/or in HII regions around faint quasars or galaxies. In one case (the intervening HII region of the faint quasar RD J1148+5253 at z=5.70 along the LOS of SDSS J1148+5251 at z=6.42) the increase of the peak spectral density is explained by the first-ever detected transverse proximity effect in the HI Lyalpha forest; this indicates that at least some peaks result from a locally enhanced radiation field. We then obtain a strong lower limit on the foreground QSO lifetime of tQ>11 Myr. The observed widths of the peaks are found to be systematically larger than the simulated ones. Reasons for such discrepancy might reside either in the photoionization equilibrium assumption or in radiative transfer effects.