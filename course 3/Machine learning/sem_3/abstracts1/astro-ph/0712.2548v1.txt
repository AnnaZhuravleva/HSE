We employ high-spatial resolution spectropolarimetric observations from the Solar Optical Telescope on-board the Hinode spacecraft to investigate the fine structure of the penumbral magnetic fields. The Stokes vector of two neutral iron lines at 630 nm is inverted at every spatial pixel to retrieve the depth-dependence of the magnetic field vector, line-of-sight velocity and thermodynamic parameters. We show that the azimuthal angle of the magnetic field vector has opposite sign on both sides above the penumbral filaments. This is consistent with the wrapping of an inclined field around the horizontal filaments. The wrapping effect is stronger for filaments with larger horizontal extensions. In addition, we find that the external magnetic field can penetrate into the intraspines, leading to non-radial magnetic fields inside them. These findings shed some light on the controversial small-scale structure of the sunspot penumbra.