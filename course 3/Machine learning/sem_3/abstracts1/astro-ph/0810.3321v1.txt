We analyse the evolution of the Intergalactic Medium (IGM) by means of an extended set of large box size hydrodynamical simulations which include pre-heating. We focus on the properties of the z~2 Lyman-alpha forest and on the population of clusters and groups of galaxies at z=0. We investigate the distribution of voids in the Lyman-alpha flux and the entropy-temperature relation of galaxy groups, comparing the simulation results to recent data from high-resolution quasar spectra and from X-ray observations. Pre-heating is included through a simple phenomenological prescription, in which at z=4 the entropy of all gas particles, whose overdensity exceeds a threshold value delta_h is increased to a minimum value K_fl. While the entropy level observed in the central regions of galaxy groups requires a fairly strong pre-heating, with K_fl>100 keV cm^2, the void statistics of the Lyman-alpha forest impose that this pre-heating should take place only in relatively high-density regions, in order not to destroy the cold filaments that give rise to the forest. We conclude that any injection of non-gravitational energy in the diffuse baryons should avoid low-density regions at high redshift and/or take place at relatively low redshift.