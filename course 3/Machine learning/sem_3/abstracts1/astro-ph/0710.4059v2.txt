The turbulent magnetic diffusivity tensor is determined in the presence of rotation or shear. The question is addressed whether dynamo action from the shear-current effect can explain large-scale magnetic field generation found in simulations with shear. For this purpose a set of evolution equations for the response to imposed test fields is solved with turbulent and mean motions calculated from the momentum and continuity equations. The corresponding results for the electromotive force are used to calculate turbulent transport coefficients. The diagonal components of the turbulent magnetic diffusivity tensor are found to be very close together, but their values increase slightly with increasing shear and decrease with increasing rotation rate. In the presence of shear, the sign of the two off-diagonal components of the turbulent magnetic diffusion tensor is the same and opposite to the sign of the shear. This implies that dynamo action from the shear--current effect is impossible, except perhaps for high magnetic Reynolds numbers. However, even though there is no alpha effect on the average, the components of the alpha tensor display Gaussian fluctuations around zero. These fluctuations are strong enough to drive an incoherent alpha--shear dynamo. The incoherent shear--current effect, on the other hand, is found to be subdominant.