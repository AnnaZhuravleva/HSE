We present new results on the evolution of the mass function of the globular cluster system of the Milky Way, taking the effect of residual gas expulsion into account. We assume that gas embedded star clusters start with a power-law mass function with slope \beta=2. The dissolution of the clusters is then studied under the combined influence of residual gas expulsion driven by energy feedback from massive stars, stellar mass-loss, two-body relaxation and an external tidal field. The influence of residual gas expulsion is studied by applying results from a large grid of N-body simulations computed by Baumgardt & Kroupa (2007).   In our model, star clusters with masses less than 10^5 M_sun lose their residual gas on timescales much shorter than their crossing time and residual gas expulsion is the main dissolution mechanism for star clusters, destroying about 95% of all clusters within a few 10s of Myr. We find that in this case the final mass function of globular clusters is established mainly by the gas expulsion and therefore nearly independent of the strength of the external tidal field, and that a power-law mass function for the gas embedded star clusters is turned into a present-day log-normal one.   Another consequence of residual gas expulsion and the associated strong infant mortality of star clusters is that the Galactic halo stars come from dissolved star clusters. Since field halo stars would come mainly from low-mass, short-lived clusters, our model provides an explanation for the observed abundance variations of light elements among globular cluster stars and the absence of such variations among the halo field stars.