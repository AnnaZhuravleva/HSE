(abbreviated version of the abstract) We study the physics of cyclotron line formation in the high-energy spectra of accreting X-ray pulsars using Monte Carlo methods, assuming that the line-forming region is a low-density electron plasma in a sub-critical magnetic field. We investigate the dependence of the shape of the fundamental line on angle, geometry, optical depth and temperature. We also discuss variations of the line ratios for non-uniform magnetic fields. These numerical predictions for the line profiles are linked to results from observational data analysis using an XSPEC model based on the Monte Carlo simulations. We apply this model to observational data from RXTE and INTEGRAL. The predicted strong emission wings of the fundamental cyclotron feature are not found in observational data, hinting at a bottom illuminated slab geometry for line formation.