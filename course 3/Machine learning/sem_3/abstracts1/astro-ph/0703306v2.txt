We use a large set of hydrodynamical simulations, combined with measurements of the Lyman alpha opacity of the IGM taken from the literature, to obtain robust estimates for the photoionization rate per hydrogen atom at z=5 and 6. We find the photoionization rate drops by a factor of two and four, respectively, compared to our recent measurements at z = 2 - 4. The number of ionizing photons emitted by known sources at z=5 and 6, based on an extrapolation of source numbers below the detection limit and standard assumptions for the relationship between the ionizing emissivity and observed luminosity density at 1500 Angstroms, are in reasonable agreement with the photoionization rates inferred from the Lyman alpha forest if the escape fraction of ionizing photons from galaxies is large (>= 20 per cent). Claims to the contrary may be attributed to the adoption of an unduly high value for the clumping factor of ionized hydrogen. Using physically motivated assumptions for the mean free path of ionizing photons our measurements of the photoionization rate can be turned into an estimate of the ionizing emissivity. In comoving units the inferred ionizing emissivity is nearly constant over the redshift range 2-6 and corresponds to 1.5-3 photons emitted per hydrogen atom over a time interval corresponding to the age of the Universe at z=6. This strongly suggests that the epoch of reionization was photon-starved and extended. [Abridged]