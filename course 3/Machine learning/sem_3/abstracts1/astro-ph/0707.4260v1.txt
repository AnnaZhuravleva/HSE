Given a set of astrometric observations of the same object, the problem of orbit determination is to compute the orbit and to assess its uncertainty and reliability. For the next generation surveys, with much larger number density of observed objects, new algorithms or substantial revisions of the classical ones are needed. The problem has three main steps, preliminary orbit, least squares orbit, and quality control. The classical theory of preliminary orbits was incomplete: the consequences of the topocentric correction had not been fully studied. We show that it is possible to account for this correction, possibly with an increase in the number of preliminary solutions, without impairing the overall orbit determination performance. We have developed modified least squares orbit determination algorithms that can be used to improve the reliability of the procedure. We have tested the complete procedure on two simulations with number densities comparable to that expected from the next generation surveys such as Pan-STARRS and LSST. To control the problem of false identifications we have introduced a quality control on the fit residuals based on an array of metrics and a procedure to remove duplications and contradictions in the output. The results confirm that large sets of discoveries can be obtained with good quality orbits and very high success rate losing only 0.6 to 1.3% of objects and a false identification rate in the range 0.02 to 0.06%.