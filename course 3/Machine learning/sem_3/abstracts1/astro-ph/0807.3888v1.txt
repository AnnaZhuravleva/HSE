The S-Z effect and Faraday rotation from halos are examined over a wide mass range, an including gas condensation and magnetic field evolution. Contributions to the CMB angular power spectrum are evaluated for galaxy clusters, galaxy groups and galaxies. Smaller mass halos are found to play a more important role than massive halos for the B-mode polarisation associated with the S-Z CMB anisotropies. The B-modes from Faraday rotation dominate the secondary B-modes caused by gravitational lensing at l > 3000. Measurement of B-mode polarisation in combination with the S-Z power spectrum can potentially provide important constraints on intracluster magnetic field and gas evolution at early epochs.