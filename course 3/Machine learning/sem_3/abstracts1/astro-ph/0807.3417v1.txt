Thermal regime of the baryons behind shock waves arising in the process of virialization of dark matter halos is governed at cetrain conditions by radiation of HD lines. A small fraction of the shocked gas can cool down to the temperature of the cosmic microwave background (CMB). We estimate an upper limit for this fraction: at $z=10$ it increases sharply from about $q_{_T}\sim 10^{-3}$ for dark halos of $M=5\times 10^7\msun$ to $\sim 0.1$ for halos with $M=10^8\msun$. Further increase of the halo mass does not lead however to a significant growth of $q_T$ -- the asymptotic value for $M\gg 10^8\msun$ is of 0.3. We estimate star formation rate associated with such shock waves, and show that they can provide a small but not negligible fraction of the star formation. We argue that extremely metal-poor low-mass stars in the Milky Way may have been formed from primordial gas behind such shocks.