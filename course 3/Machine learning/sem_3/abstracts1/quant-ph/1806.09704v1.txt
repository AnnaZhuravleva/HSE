We propose a robust scheme for generating macroscopic superposition states of spin or motion with the aid of a single photon. Shaping the wave packet of the photon enables high-fidelity preparation of non-classical states of matter even in the presence of photon loss. Success is heralded by photodetection, enabling the scheme to be implemented with a weak coherent field. We analyze applications to preparing Schr\"{o}dinger cat states of a collective atomic spin or of a mechanical oscillator coupled to an optical resonator. The method generalizes to preparing arbitrary superpositions of coherent states, enabling full quantum control. We illustrate this versatility by showing how to prepare Dicke or Fock states, as well as superpositions in the Dicke or Fock basis.