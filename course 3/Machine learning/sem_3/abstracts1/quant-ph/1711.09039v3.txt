We provide a security analysis of continuous-variable quantum key distribution (CVQKD) with discrete modulation against general attacks in a realistic finite-size regime. To realize this goal, we first prove security of the continuous-variable quantum key distribution protocol with discrete modulation against collective attacks by using the reliable tomography of the covariance matrix, leading to the reliable and tight error bounds in the derived confidence regions. Combining the proof with de Finetti reduction, the discrete-modulation-based continuous-variable quantum key distribution (DM-CVQKD) is proved to be secure even exposing to general attacks. Specially, we use an energy test to truncate the Hilbert space globally to provide security.