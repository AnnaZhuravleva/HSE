On-chip single-photon sources are key components for integrated photonic quantum technologies. Semiconductor quantum dots can exhibit near-ideal single-photon emission but this can be significantly degraded in on-chip geometries owing to nearby etched surfaces. A long-proposed solution to improve the indistinguishablility is by using the Purcell effect to reduce the radiative lifetime. However, until now only modest Purcell enhancements have been observed. Here we use pulsed resonant excitation to eliminate slow relaxation paths, revealing a highly Purcell-shortened radiative lifetime (22.7 ps) in a waveguide-coupled quantum dot-photonic crystal cavity system. This leads to near-lifetime-limited single-photon emission which retains high indistinguishablility (93.9%) on a timescale in which 20 photons may be emitted. Nearly background-free pulsed resonance fluorescence is achieved under $\pi$-pulse excitation, enabling demonstration of an on-chip, on-demand single-photon source with very high potential repetition rates.