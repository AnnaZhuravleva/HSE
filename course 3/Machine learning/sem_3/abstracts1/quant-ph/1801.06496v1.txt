The discrete-variable QKD protocols based on BB84 are known to be secure against an eavesdropper, Eve, intercepting the flying qubits and performing any quantum operation on them. However, these protocols may still be vulnerable to side-channel attacks. We investigate the Trojan-Horse side-channel attack where Eve sends her own state into Alice's apparatus and measures the reflected state to estimate the key. We prove that the separable coherent state is optimal for Eve amongst the class of multi-mode Gaussian attack states. We describe how Alice may defend against this by adding thermal noise to the system and give an analytic expression of the resulting secret key rate. We also provide a bound on the secret key rate in the case where Eve may use any separable state, and describe an active defense system based on optical modulators.