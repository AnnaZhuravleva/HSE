We report the implementation of a high-rate source of single and two-photon states. By combining the advantages of short pulses and cavities, heralding rates up to 250kHz with 88% fidelity have been obtained for the single photons as well as 800Hz with 82% fidelity for the two-photon states. Furthermore, we developed a setup where the homodyne measurement is conditioned by the heralding of the quantum states, enabling the detection of most of the heralded events. This allows a faster characterization of the photon source leading to an increase in the fidelities up to 91% and 88% respectively for the single-photon and two-photon Fock states. Such high rates and fidelities in the generation of elementary Fock states may open the path for the production of complex quantum states.