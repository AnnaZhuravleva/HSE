Systems that are driven out of thermal equilibrium typically dissipate random quantities of energy on microscopic scales. Crooks fluctuation theorem relates the distribution of these random work costs with the corresponding distribution for the reverse process. By an analysis that explicitly incorporates the energy reservoir that donates the energy, and the control system that implements the dynamic, we here obtain a quantum generalization of Crooks theorem that not only includes the energy changes in the reservoir, but the full description of its evolution, including coherences. This approach moreover opens up for generalizations of the concept of fluctuation relations. Here we introduce `conditional' fluctuation relations that are applicable to non-equilibrium systems, as well as approximate fluctuation relations that allow for the analysis of autonomous evolution generated by global time-independent Hamiltonians. We furthermore extend these notions to Markovian master equations, implicitly modeling the influence of the heat bath.