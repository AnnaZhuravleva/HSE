We propose an extension of the 3-3-1 model with an additional symmetry group $Z_{2}\times Z_{4} \times U(1)_{L_g}$ and an extended scalar sector. To our best knowledge this is the first example of a renormalizable 3-3-1 model, which allows explanation of the SM fermion mass hierarchy by a sequential loop suppression: tree-level top and exotic fermion masses, 1-loop bottom, charm, tau and muon masses; 2-loop masses for the light up, down, strange quarks as well as for the electron. The light active neutrino masses are generated from a combination of linear and inverse seesaw mechanisms at two loop level. The model also has viable fermionic and scalar dark matter candidates.