Motivated by the recent LHCb flavor anomalies, we consider a model with an $L_\mu - L_\tau$ gauge symmetry and additional vector-like fermions. We find that by introducing supersymmetry the model can be made consistent with the long-standing deviation in the measured value of the anomalous magnetic moment of the muon, $g-2$, and neutralino dark matter of broad mass ranges and properties. In particular, dark matter candidates include the well-known 1 TeV higgsino, which in the MSSM is typically not compatible with solutions to the $g-2$ puzzle. Moreover, its spin-independent cross section could be at the origin of the recent small excess in XENON-1T data. We apply to the model constraints arising from flavor precision measurements and direct searches at the Large Hadron Collider and show that they do not currently exclude the relevant parameter space regions.