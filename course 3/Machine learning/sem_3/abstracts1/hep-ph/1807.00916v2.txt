The lifetimes of bottom and charmed hadrons are analyzed within the framework of the heavy quark expansion (HQE). Lifetime differences arise from the spectator effects such as weak $W$-annihilation and Pauli interference. Spectator effects originating from dimension-7 four-quark operators are derived. Hadronic matrix elements of four-quark operators are parameterized in a model-independent way. Using the dimension-6 bag parameters recently determined from HQET sum rules and the vacuum insertion approximation for meson matrix elements of dimension-7 operators, the calculated $B$ meson lifetime ratios $\tau(B^+)/\tau(B^0_d)=1.074$ and $\tau(B^0_s)/\tau(B^0_d)=0.996$ are in excellent agreement with experiment. Likewise, based on the quark model evaluation of baryon matrix elements, the resulting baryon lifetime ratios $\tau(\Xi_b^-)/\tau(\Lambda_b^0)$, $\tau(\Xi_b^-)/\tau(\Xi_b^0)$, $\tau(\Omega_b^-)/\tau(\Xi_b^-)$ and the $\Lambda_b-B^0$ lifetime ratio $\tau(\Lambda_b^0)/\tau(B^0_d)=0.955$ also agree well with the data. Contrary to the bottom hadron sector where the HQE in $1/m_b$ works well, the HQE to $1/m_c^3$ fails to give a satisfactory description of the lifetimes of both charmed mesons and charmed baryons. This calls for the subleading $1/m_Q$ corrections to spectator effects. The relevant dimension-7 spectator effects are in the right direction for explaining the large lifetime ratio of $\tau(\Xi_c^+)/\tau(\Lambda_c^+)$.