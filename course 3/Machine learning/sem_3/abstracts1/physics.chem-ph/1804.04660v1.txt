We consider nonadiabatic systems in which the classical Born-Oppenheimer approximation breaks down. We present a general theory that accurately captures the full transmitted wavepacket after multiple transitions through either a single or distinct avoided crossings, including phase information and associated interference effects. Under suitable approximations, we recover both the celebrated Landau-Zener formula and standard surface-hopping algorithms. Our algorithm shows excellent agreement with the full quantum dynamics for a range of avoided crossing systems, and can also be applied to single full crossings with similar accuracy.